<!DOCTYPE html>
<html>
<head>
   <title>Firebase Image Display using HTML and JavaScript</title>
   <style>
      #imageList {
         margin-top: 20px;
      }
   </style>
</head>
<body>
   <div id="imageList"></div>
</body>
<script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-storage.js"></script>
<script>
 const firebaseConfig = {
    apiKey: "AIzaSyBiyqkXU0JTxEZdmfKGrtuMTvIGvYGq7Fw",
    authDomain: "uploadimg-a8243.firebaseapp.com",
    databaseURL: "https://uploadimg-a8243-default-rtdb.firebaseio.com",
    projectId: "uploadimg-a8243",
    storageBucket: "uploadimg-a8243.appspot.com",
    messagingSenderId: "661895407436",
    appId: "1:661895407436:web:7523d8bf57c672f66ed1e9"
  };

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
console.log(firebase);

function uploadImage() {
   const ref = firebase.storage().ref();
   const file = document.querySelector("#photo").files[0];
   const name = +new Date() + "-" + file.name;
   const metadata = {
      contentType: file.type
   };
   const task = ref.child(name).put(file, metadata);

   task
      .then(snapshot => snapshot.ref.getDownloadURL())
      .then(url => {
         console.log(url);
         alert('Image uploaded successfully');
         document.querySelector("#image").src = url;
         document.querySelector("#errorMsg").textContent = ""; // Clear any previous error message
      })
      .catch(error => {
         console.error(error);
         document.querySelector("#errorMsg").textContent = "Error uploading image.";
      });
}

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
console.log(firebase);

function uploadImage() {
   const ref = firebase.storage().ref();
   const file = document.querySelector("#photo").files[0];
   const name = +new Date() + "-" + file.name;
   const metadata = {
      contentType: file.type
   };
   const task = ref.child(name).put(file, metadata);

   task
      .then(snapshot => snapshot.ref.getDownloadURL())
      .then(url => {
         console.log(url);
         alert('Image uploaded successfully');
         document.querySelector("#image").src = url;
         document.querySelector("#errorMsg").textContent = ""; // Clear any previous error message
      })
      .catch(error => {
         console.error(error);
         document.querySelector("#errorMsg").textContent = "Error uploading image.";
      });
}

const storageRef = firebase.storage().ref();
const imageList = document.getElementById("imageList");

// Function to display images
function displayImages() {
   imageList.innerHTML = ""; // Clear existing images

   // List all items in the storage bucket
   storageRef.listAll().then((result) => {
      result.items.forEach((itemRef) => {
         // Get the download URL for each image and create an image element
         itemRef.getDownloadURL().then((url) => {
            const img = document.createElement("img");
            img.src = url;
            imageList.appendChild(img);
         });
      });
   }).catch((error) => {
      console.error(error);
   });
}

// Call the displayImages function to show existing images
displayImages();
</script>
</html>
